<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Drag and drop</title>
    <style>
        * {
            font-family: 'Courier New', Courier, monospace;
        }

        form input {
            border-radius: 5px;
        }
        div:not(#contenedor) {
            border: 1px black solid;
            border-radius: 5px;
            text-align: center;
            padding: 2px;
        }
        #contenedorBookmarks > div:not(:first-child):hover {
            cursor: pointer;
        }

        #contenedorEtiquetas > div:not(:first-child):hover {
            cursor: pointer;
        }
    </style>
	<script>
        //usar la lista como zona de drop para añadir, el ultimo campo [drop] como zona para borrar. por ejemplo
        class Bookmark{
            constructor(titulo,url,descripcion,etiquetas){
                this.titulo = titulo;
                this.url = url;
                this.descripcion = descripcion;
                this.etiquetas = etiquetas;
            }
            html(y){
                var t = this;
                var ele = document.createElement("div");
                ele.id = y;
                ele.innerHTML="bookmark "+y;
                ele.draggable="true";
                ele.addEventListener("drag", function(ev) {
                ev.preventDefault();
                });
                ele.addEventListener("dragstart", function(ev) {
                ev.dataTransfer.setData("Text", ele.id);
                });
                ele.addEventListener("click", mostrarContenido.bind(null,t));
                document.getElementById("contenedorBookmarks").append(ele);
            }
        }

        function iniciar() {

            //Contenedor principal
            var contenedor = document.createElement("div");
            contenedor.id = "contenedor";
            contenedor.style.display="flex";
            contenedor.style.justifyContent="space-evenly"
            contenedor.style.width="100%";
            document.body.appendChild(contenedor);

            //Datos de partida
            numB = window.prompt("Número de bookmarks");
            numE = window.prompt("Número de etiquetas");
            divBookmarks(numB);
            divEtiquetas(numE);
        }

        /*function divFiltro(arrayEtiquetas) {
            
        }*/

        function divBookmarks(x) {

            //Contenedor de los bookmarks
            var contenedorBookmarks = document.createElement("div");
            contenedorBookmarks.id = "contenedorBookmarks";
            contenedorBookmarks.style.display="flex";
            contenedorBookmarks.style.flexDirection="column";
            document.getElementById("contenedor").appendChild(contenedorBookmarks);

            //Div del título
            var title = document.createElement("div");
            title.innerHTML="BOOKMARKS";
            document.getElementById("contenedorBookmarks").appendChild(title);
            
            //Div del contenido
            var contenedorContenido = document.createElement("div");
            contenedorContenido.id = "contenedorContenido";
            contenedorContenido.style.flexBasis="21.5rem";
            document.getElementById("contenedor").appendChild(contenedorContenido);
            contenedorContenido.addEventListener("drop", function(ev) {
            ev.preventDefault();
            var data = ev.dataTransfer.getData("Text");
            var nodeCopy = document.getElementById(data).cloneNode(true);
            ev.target.appendChild(nodeCopy);
            });
            contenedorContenido.addEventListener("dragover", function(ev) {
            ev.preventDefault();
            });

            //Formulario
            var form = document.createElement("form");
            form.id = "form";
            //Título
            var iTxt = document.createElement("input");
            iTxt.setAttribute('type',"text");
            iTxt.setAttribute('value',"Título");
            iTxt.setAttribute('readOnly',"true");
            iTxt.style.border="none";
            var i = document.createElement("input");
            i.setAttribute('type',"text");
            i.setAttribute('name',"titulo");
            
            //URL
            var i2Txt = document.createElement("input");
            i2Txt.setAttribute('type',"text");
            i2Txt.setAttribute('value',"URL");
            i2Txt.setAttribute('readOnly',"true");
            i2Txt.style.border="none";
            var i2 = document.createElement("input");
            i2.setAttribute('type',"text");
            i2.setAttribute('name',"url");
            //Descripción
            var i3Txt = document.createElement("input");
            i3Txt.setAttribute('type',"text");
            i3Txt.setAttribute('value',"Descripción");
            i3Txt.setAttribute('readOnly',"true");
            i3Txt.style.border="none";
            var i3 = document.createElement("input");
            i3.setAttribute('type',"text");
            i3.setAttribute('name',"descripcion");

            /*var s = document.createElement("input");
            s.setAttribute('type',"submit");
            s.setAttribute('value',"Guardar");*/

            form.appendChild(iTxt);
            form.appendChild(i);
            form.appendChild(i2Txt);
            form.appendChild(i2);
            form.appendChild(i3Txt);
            form.appendChild(i3);
            //form.appendChild(s);

            document.getElementById("contenedorContenido").appendChild(form);

            //Botón añadir
            var add = document.createElement("div");
            add.innerHTML="[ + ]";
            add.addEventListener("click",addBookmark);
            document.getElementById("contenedorBookmarks").appendChild(add);

            //Drop eliminar
            var del = document.createElement("div");
            del.style.order="50";
            del.addEventListener("drop", function(ev) {
                ev.preventDefault();
                var data = ev.dataTransfer.getData("Text");
                ev.target.parentNode.removeChild(document.getElementById(data));
                console.log(data);
            });
            del.addEventListener("dragover", function(ev) {
            ev.preventDefault();
            });
            del.innerHTML="Arrastre aquí para eliminar";
            document.getElementById("contenedorBookmarks").appendChild(del);

            for (let i=0; i < x; i++) {
                var book = new Bookmark("B"+i,"url de B"+i,"descripcion de B"+i);
                book.html(i);
                console.log(book);
            }
        }

        function divContenido(t,u,d,e) {
            //Muestra los valores del elemento que hizo click
            document.getElementById("form").elements["titulo"].value = t;
            document.getElementById("form").elements["url"].value = u;
            document.getElementById("form").elements["descripcion"].value = d;
            //var displayE = document.createElement("div");
            //displayE.id="displayE";
            //document.getElementById("contenedorContenido").appendChild(displayE);

            //Botón guardar falta funcionalidad
        }

        function divEtiquetas(x) {

            //Contenerodr de las etiquetas
            var contenedorEtiquetas = document.createElement("div");
            contenedorEtiquetas.id = "contenedorEtiquetas";
            contenedorEtiquetas.style.display="flex";
            contenedorEtiquetas.style.flexDirection="column";
            document.getElementById("contenedor").appendChild(contenedorEtiquetas);

            //Div del título
            var title = document.createElement("div");
            title.innerHTML="ETIQUETAS";
            document.getElementById("contenedorEtiquetas").appendChild(title);

            //Botón añadir
            var add = document.createElement("div");
            add.innerHTML="[ + ]";
            add.addEventListener("click",addTag);
            document.getElementById("contenedorEtiquetas").appendChild(add);

            for (let i=0; i < x; i++) {
                var elem = document.createElement("div");
                elem.innerHTML="etiqueta " + i;
                elem.id="E"+i;
                elem.draggable="true";
                elem.addEventListener("drag", function(ev) {
                ev.preventDefault();
                });
                elem.addEventListener("dragstart", function(ev) {
                ev.dataTransfer.setData("Text", "E"+i);
                });
                document.getElementById("contenedorEtiquetas").appendChild(elem);
            }
            //Drop eliminar
            var del = document.createElement("div");
            del.style.order="50";
            del.addEventListener("drop", function(ev) {
            ev.preventDefault();
            var data = ev.dataTransfer.getData("Text");
            console.log(data);
            ev.target.parentNode.removeChild(document.getElementById(data));
            });
            del.addEventListener("dragover", function(ev) {
            ev.preventDefault();
            });
            del.innerHTML="Arrastre aquí para eliminar";
            document.getElementById("contenedorEtiquetas").appendChild(del);
        }

        //Cuando se hace click en un bookmark
        function mostrarContenido(o) {
            t = o.titulo;
            u = o.url;
            d = o.descripcion;
            e = o.etiquetas;
            divContenido(t,u,d,e);
        }

        //Cuando se hace click en añadir
        function addBookmark() {
            var book = new Bookmark("B"+numB,"url de B"+numB,"descripcion de B"+numB);
            book.html(numB);
            numB++;
        }

        //Cuando se hace click en añadir
        function addTag() {
            var elem = document.createElement("div");
            elem.id="E"+numE;
            elem.draggable="true";
            elem.addEventListener("drag", function(ev) {
            ev.preventDefault();
            });
            elem.addEventListener("dragstart", function(ev) {
            ev.dataTransfer.setData("Text", elem.id);
            });
            elem.innerHTML="etiqueta " + numE;
            document.getElementById("contenedorEtiquetas").appendChild(elem);
            numE++;
        }


        window.onload=iniciar;
    </script>
</head>
<body>

</body>
</html>